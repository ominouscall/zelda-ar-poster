<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Twilight Memory</title>

<style>
    @font-face {
        font-family: "WiiRegular";
        src: url("TPHylian-WiiRegular.otf");
    }
    @font-face {
        font-family: "GCNBold";
        src: url("TPHylian-GCNBold.otf");
    }

    body {
        margin: 0;
        overflow: hidden;
        background: black;
        font-family: "WiiRegular", serif;
    }

    /* background video: transition added so filters crossfade smoothly */
    #bgVideo {
        position: fixed;
        top: 0; left: 0;
        width: 100vw;
        height: 100vh;
        object-fit: cover;
        z-index: 1;
        transition: filter 1s ease; /* <--- adicionado */
    }

    /* morning / afternoon / night filters */
    .morningFilter {
        filter: brightness(1.12) saturate(1.08) sepia(0.06) hue-rotate(-8deg);
    }
    .afternoonFilter {
        filter: brightness(1.02) saturate(1.12) hue-rotate(6deg) contrast(1.02);
    }
    .nightFilter {
       filter: brightness(0.55) contrast(1.08) saturate(1.15) hue-rotate(185deg) sepia(0.18);
    }

    #secretVideo {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;  /* largura exata da tela */
        height: 100vh; /* altura exata da tela */
        object-fit: fill; /* <-- ESTICA o vídeo pra caber */
        z-index: 9999;
        display: none;
        background: black;
    }
    
    #overlay {
        position: fixed;
        top: 0; left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0,0,0,0.5);
        z-index: 2;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        backdrop-filter: blur(2px);
    }

    #quote {
        font-family: "WiiRegular";
        color: #e8d8a8;
        font-size: 1.3rem;
        max-width: 90vw;
        text-align: center;
        margin-bottom: 40px;
        text-shadow: 2px 2px 4px black;
    }

    #startButton {
        font-family: "GCNBold";
        font-size: 2rem;
        color: #e8d8a8;
        border: 2px solid #e8d8a8;
        padding: 12px 28px;
        border-radius: 4px;
        cursor: pointer;
        background: rgba(0,0,0,0.6);
        text-shadow: 2px 2px 4px black;
        transition: 0.25s;
    }

    #startButton:hover {
        background: rgba(255,255,255,0.1);
        transform: scale(1.05);
    }

    /* Fade overlay */
    #fadeLayer {
        position: fixed;
        top: 0; left: 0;
        width: 100vw;
        height: 100vh;
        background: black;
        z-index: 8;
        opacity: 0;
        pointer-events: none;
        transition: opacity 1s ease;
    }

    /* INVISIBLE CLICK AREA ABOVE LINK'S HEAD */
    #linkHitbox {
        position: fixed;
        width: 10vw;   /* responsive size */
        height: 10vw;
        max-width: 150px;
        max-height: 150px;
        left: 18vw;   /* from your marked screenshot */
        top: 40vh;
        z-index: 5;
        background: rgba(0, 255, 0, 0.4); /* fully transparent */
    }
</style>
</head>

<body>

<!-- Background looping video -->
<video id="bgVideo" src="video.mp4" autoplay loop muted playsinline></video>

<!-- Secret cutscene -->
<video id="secretVideo" src="easter-eggs/creepy-link-scene.mp4" playsinline></video>

<!-- Music -->
<audio id="bgMusic" src="music.mp3" loop></audio>
<audio id="pressSound" src="press-start.mp3"></audio>

<div id="overlay">
    <div id="quote"></div>
    <div id="startButton">PRESS START</div>
</div>

<div id="fadeLayer"></div>

<!-- Invisible hitbox used for the 10-click easter egg -->
<div id="linkHitbox"></div>

<script>
/* Famous Twilight Princess quotes */
const quotes = [
    "“A sword wields no strength unless the hand that holds it has courage.”",
    "“Shadow and light are two sides of the same coin.”",
    "“Hero of Twilight, lend your power to this sacred blade.”",
    "“The twilight there holds a serene beauty… you have seen it for yourself.”",
    "“I... I wanted to see you again, Link.”",
    "“Courage need not be remembered, for it is never forgotten.”",
    "“Light and shadow can't mix as one, but they can coexist.”"
];

document.getElementById("quote").innerText =
    quotes[Math.floor(Math.random() * quotes.length)];

const bgMusic = document.getElementById("bgMusic");
const pressSound = document.getElementById("pressSound");
const overlay = document.getElementById("overlay");
const fadeLayer = document.getElementById("fadeLayer");

const bgVideo = document.getElementById("bgVideo");
const secretVideo = document.getElementById("secretVideo");

/* ---------- TIME-OF-DAY FILTER (ADDED) ---------- */
function applyTimeFilter() {
    // local device hour
    const hour = new Date().getHours();
    // remove any previously applied classes
    bgVideo.classList.remove('morningFilter', 'afternoonFilter', 'nightFilter');

    if (hour >= 6 && hour < 12) {
        // morning
        bgVideo.classList.add('morningFilter');
    } else if (hour >= 12 && hour < 18) {
        // afternoon
        bgVideo.classList.add('afternoonFilter');
    } else {
        // night (18:00 - 06:00)
        bgVideo.classList.add('nightFilter');
    }
}

// call once at load
applyTimeFilter();
/* ---------- END TIME FILTER ---------- */

document.getElementById("startButton").onclick = () => {
    pressSound.play();

    overlay.style.opacity = "0";
    overlay.style.pointerEvents = "none";
    overlay.style.transition = "opacity 1.5s ease";

    /* Fade-in for music */
    bgMusic.volume = 0;
    bgMusic.play();
    let vol = 0;
    const fadeInterval = setInterval(() => {
        if (vol < 1) {
            vol += 0.02;
            bgMusic.volume = vol;
        } else {
            clearInterval(fadeInterval);
        }
    }, 80);
};

/* Easter Egg: 10 fast clicks on Link hitbox */
let clickCount = 0;
let lastClickTime = 0;

document.getElementById("linkHitbox").addEventListener("click", () => {
    const now = Date.now();

    if (now - lastClickTime < 400) {
        clickCount++;
    } else {
        clickCount = 1;
    }

    lastClickTime = now;

    if (clickCount >= 10) {
        triggerSecretCutscene();
        clickCount = 0;
    }
});

function triggerSecretCutscene() {
    /* Fade to black */
    fadeLayer.style.opacity = "1";

    setTimeout(() => {
        /* Pause music & main video */
        bgMusic.pause();
        bgVideo.pause();

        /* Start secret video */
        secretVideo.style.display = "block";
        secretVideo.currentTime = 0;
        secretVideo.play();

        /* When secret video ends, fade out */
        secretVideo.onended = () => {
            fadeLayer.style.opacity = "1";

            setTimeout(() => {
                secretVideo.style.display = "none";
                bgVideo.play();
                bgMusic.play();
                fadeLayer.style.opacity = "0";
            }, 800);
        };

        fadeLayer.style.opacity = "0";
    }, 800);
}
</script>

</body>
</html>
